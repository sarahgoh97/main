= PrisonBook - Developer Guide
:toc:
:toc-title:
:toc-placement: preamble
:sectnums:
:imagesDir: images
:stylesDir: stylesheets
:xrefstyle: full
ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
endif::[]
:repoURL: https://github.com/CS2103JAN2018-T11-B2/main/

By: `CS2103-T11-B2`      Since: `Jan 2018`      Licence: `MIT`

== Setting up

=== Prerequisites

. *JDK `1.8.0_60`* or later
+
[NOTE]
Having any Java 8 version is not enough. +
This app will not work with earlier versions of Java 8.
+

. *IntelliJ* IDE
+
[NOTE]
IntelliJ by default has Gradle and JavaFx plugins installed. +
Do not disable them. If you have disabled them, go to `File` > `Settings` > `Plugins` to re-enable them.


=== Setting up the project in your computer

. Fork this repo, and clone the fork to your computer
. Open IntelliJ (if you are not in the welcome screen, click `File` > `Close Project` to close the existing project dialog first)
. Set up the correct JDK version for Gradle
.. Click `Configure` > `Project Defaults` > `Project Structure`
.. Click `New...` and find the directory of the JDK
. Click `Import Project`
. Locate the `build.gradle` file and select it. Click `OK`
. Click `Open as Project`
. Click `OK` to accept the default settings
. Open a console and run the command `gradlew processResources` (Mac/Linux: `./gradlew processResources`). It should finish with the `BUILD SUCCESSFUL` message. +
This will generate all resources required by the application and tests.

=== Verifying the setup

. Run the `seedu.address.MainApp` and try a few commands
. <<Testing,Run the tests>> to ensure they all pass.

=== Configurations to do before writing code

==== Configuring the coding style

This project follows https://github.com/oss-generic/process/blob/master/docs/CodingStandards.adoc[oss-generic coding standards]. IntelliJ's default style is mostly compliant with ours but it uses a different import order from ours. To rectify,

. Go to `File` > `Settings...` (Windows/Linux), or `IntelliJ IDEA` > `Preferences...` (macOS)
. Select `Editor` > `Code Style` > `Java`
. Click on the `Imports` tab to set the order

* For `Class count to use import with '\*'` and `Names count to use static import with '*'`: Set to `999` to prevent IntelliJ from contracting the import statements
* For `Import Layout`: The order is `import static all other imports`, `import java.\*`, `import javax.*`, `import org.\*`, `import com.*`, `import all other imports`. Add a `<blank line>` between each `import`

Optionally, you can follow the <<UsingCheckstyle#, UsingCheckstyle.adoc>> document to configure Intellij to check style-compliance as you write code.

==== Updating documentation to match your fork

After forking the repo, links in the documentation will still point to the `se-edu/addressbook-level4` repo. If you plan to develop this as a separate product (i.e. instead of contributing to the `se-edu/addressbook-level4`) , you should replace the URL in the variable `repoURL` in `DeveloperGuide.adoc` and `UserGuide.adoc` with the URL of your fork.

==== Setting up CI

Set up Travis to perform Continuous Integration (CI) for your fork. See <<UsingTravis#, UsingTravis.adoc>> to learn how to set it up.

After setting up Travis, you can optionally set up coverage reporting for your team fork (see <<UsingCoveralls#, UsingCoveralls.adoc>>).

[NOTE]
Coverage reporting could be useful for a team repository that hosts the final version but it is not that useful for your personal fork.

Optionally, you can set up AppVeyor as a second CI (see <<UsingAppVeyor#, UsingAppVeyor.adoc>>).

[NOTE]
Having both Travis and AppVeyor ensures your App works on both Unix-based platforms and Windows-based platforms (Travis is Unix-based and AppVeyor is Windows-based)

==== Getting started with coding

When you are ready to start coding,

1. Get some sense of the overall design by reading <<Design-Architecture>>.
2. Take a look at <<GetStartedProgramming>>.

== Design

[[Design-Architecture]]
=== Architecture

.Architecture Diagram
image::Architecture.png[width="600"]

The *_Architecture Diagram_* given above explains the high-level design of the App. Given below is a quick overview of each component.

[TIP]
The `.pptx` files used to create diagrams in this document can be found in the link:{repoURL}/docs/diagrams/[diagrams] folder. To update a diagram, modify the diagram in the pptx file, select the objects of the diagram, and choose `Save as picture`.

`Main` has only one class called link:{repoURL}/src/main/java/seedu/address/MainApp.java[`MainApp`]. It is responsible for,

* At app launch: Initializes the components in the correct sequence, and connects them up with each other.
* At shut down: Shuts down the components and invokes cleanup method where necessary.

<<Design-Commons,*`Commons`*>> represents a collection of classes used by multiple other components. Two of those classes play important roles at the architecture level.

* `EventsCenter` : This class (written using https://github.com/google/guava/wiki/EventBusExplained[Google's Event Bus library]) is used by components to communicate with other components using events (i.e. a form of _Event Driven_ design)
* `LogsCenter` : Used by many classes to write log messages to the App's log file.

The rest of the App consists of four components.

* <<Design-Ui,*`UI`*>>: The UI of the App.
* <<Design-Logic,*`Logic`*>>: The command executor.
* <<Design-Model,*`Model`*>>: Holds the data of the App in-memory.
* <<Design-Storage,*`Storage`*>>: Reads data from, and writes data to, the hard disk.

Each of the four components

* Defines its _API_ in an `interface` with the same name as the Component.
* Exposes its functionality using a `{Component Name}Manager` class.

For example, the `Logic` component (see the class diagram given below) defines it's API in the `Logic.java` interface and exposes its functionality using the `LogicManager.java` class.

.Class Diagram of the Logic Component
image::LogicClassDiagram.png[width="800"]

[discrete]
==== Events-Driven nature of the design

The _Sequence Diagram_ below shows how the components interact for the scenario where the user issues the command `delete 1`.

.Component interactions for `delete 1` command (part 1)
image::SDforDeletePerson.png[width="800"]

[NOTE]
Note how the `Model` simply raises a `AddressBookChangedEvent` when PrisonBook data is changed, instead of asking the `Storage` to save the updates to the hard disk.

The diagram below shows how the `EventsCenter` reacts to that event, which eventually results in the updates being saved to the hard disk and the status bar of the UI being updated to reflect the 'Last Updated' time.

.Component interactions for `delete 1` command (part 2)
image::SDforDeletePersonEventHandling.png[width="800"]

[NOTE]
Note how the event is propagated through the `EventsCenter` to the `Storage` and `UI` without `Model` having to be coupled to either of them. This is an example of how this Event Driven approach helps us reduce direct coupling between components.

The sections below give more details of each component.

[[Design-Ui]]
=== UI component

.Structure of the UI Component
image::UiClassDiagram.png[width="800"]

*API* : link:{repoURL}/src/main/java/seedu/address/ui/Ui.java[`Ui.java`]

The UI consists of a `MainWindow` that is made up of parts e.g.`CommandBox`, `ResultDisplay`, `PersonListPanel`, `StatusBarFooter`, `BrowserPanel` etc. All these, including the `MainWindow`, inherit from the abstract `UiPart` class.

The `UI` component uses JavaFx UI framework. The layout of these UI parts are defined in matching `.fxml` files that are in the `src/main/resources/view` folder. For example, the layout of the link:{repoURL}/src/main/java/seedu/address/ui/MainWindow.java[`MainWindow`] is specified in link:{repoURL}/src/main/resources/view/MainWindow.fxml[`MainWindow.fxml`]

The `UI` component,

* Executes user commands using the `Logic` component.
* Binds itself to some data in the `Model` so that the UI can auto-update when data in the `Model` change.
* Responds to events raised from various parts of the App and updates the UI accordingly.

[[Design-Logic]]
=== Logic component

[[fig-LogicClassDiagram]]
.Structure of the Logic Component
image::LogicClassDiagram.png[width="800"]

.Structure of Commands in the Logic Component. This diagram shows finer details concerning `XYZCommand` and `Command` in <<fig-LogicClassDiagram>>
image::LogicCommandClassDiagram.png[width="800"]

*API* :
link:{repoURL}/src/main/java/seedu/address/logic/Logic.java[`Logic.java`]

.  `Logic` uses the `AddressBookParser` class to parse the user command.
.  This results in a `Command` object which is executed by the `LogicManager`.
.  The command execution can affect the `Model` (e.g. adding a person) and/or raise events.
.  The result of the command execution is encapsulated as a `CommandResult` object which is passed back to the `Ui`.

Given below is the Sequence Diagram for interactions within the `Logic` component for the `execute("delete 1")` API call.

.Interactions Inside the Logic Component for the `delete 1` Command
image::DeletePersonSdForLogic.png[width="800"]

[[Design-Model]]
=== Model component

.Structure of the Model Component
image::ModelClassDiagram.png[width="800"]

*API* : link:{repoURL}/src/main/java/seedu/address/model/Model.java[`Model.java`]

The `Model`,

* stores a `UserPref` object that represents the user's preferences.
* stores PrisonBook data.
* stores the cells in the prison.
* exposes an unmodifiable `ObservableList<Person>` that can be 'observed' e.g. the UI can be bound to this list so that the UI automatically updates when the data in the list changes.
* exposes an unmodifiable `ObservableList<Cell>` that can be 'observed' in a map e.g. the UI can be bound to this list so that the UI automatically updates when the data in the list changes.
* does not depend on any of the other three components.

[[Design-Storage]]
=== Storage component

.Structure of the Storage Component
image::StorageClassDiagram.png[width="800"]

*API* : link:{repoURL}/src/main/java/seedu/address/storage/Storage.java[`Storage.java`]

The `Storage` component,

* can save `UserPref` objects in json format and read it back.
* can save the PrisonBook data in xml format and read it back.
* can save the user database in xml format and read it back.

[[Design-Commons]]
=== Common classes

Classes used by multiple components are in the `seedu.addressbook.commons` package.

== Implementation

This section describes some noteworthy details on how certain features are implemented.

// tag::undoredo[]
=== Undo/Redo feature
==== Current Implementation

The undo/redo mechanism is facilitated by an `UndoRedoStack`, which resides inside `LogicManager`. It supports undoing and redoing of commands that modifies the state of the address book (e.g. `add`, `edit`). Such commands will inherit from `UndoableCommand`.

`UndoRedoStack` only deals with `UndoableCommands`. Commands that cannot be undone will inherit from `Command` instead. The following diagram shows the inheritance diagram for commands:

image::LogicCommandClassDiagram.png[width="800"]

As you can see from the diagram, `UndoableCommand` adds an extra layer between the abstract `Command` class and concrete commands that can be undone, such as the `DeleteCommand`. Note that extra tasks need to be done when executing a command in an _undoable_ way, such as saving the state of the address book before execution. `UndoableCommand` contains the high-level algorithm for those extra tasks while the child classes implements the details of how to execute the specific command. Note that this technique of putting the high-level algorithm in the parent class and lower-level steps of the algorithm in child classes is also known as the https://www.tutorialspoint.com/design_pattern/template_pattern.htm[template pattern].

Commands that are not undoable are implemented this way:
[source,java]
----
public class ListCommand extends Command {
    @Override
    public CommandResult execute() {
        // ... list logic ...
    }
}
----

With the extra layer, the commands that are undoable are implemented this way:
[source,java]
----
public abstract class UndoableCommand extends Command {
    @Override
    public CommandResult execute() {
        // ... undo logic ...

        executeUndoableCommand();
    }
}

public class DeleteCommand extends UndoableCommand {
    @Override
    public CommandResult executeUndoableCommand() {
        // ... delete logic ...
    }
}
----

Suppose that the user has just launched the application. The `UndoRedoStack` will be empty at the beginning.

The user executes a new `UndoableCommand`, `delete 5`, to delete the 5th person in the address book. The current state of the address book is saved before the `delete 5` command executes. The `delete 5` command will then be pushed onto the `undoStack` (the current state is saved together with the command).

image::UndoRedoStartingStackDiagram.png[width="800"]

As the user continues to use the program, more commands are added into the `undoStack`. For example, the user may execute `add n/David ...` to add a new person.

image::UndoRedoNewCommand1StackDiagram.png[width="800"]

[NOTE]
If a command fails its execution, it will not be pushed to the `UndoRedoStack` at all.

The user now decides that adding the person was a mistake, and decides to undo that action using `undo`.

We will pop the most recent command out of the `undoStack` and push it back to the `redoStack`. We will restore the address book to the state before the `add` command executed.

image::UndoRedoExecuteUndoStackDiagram.png[width="800"]

[NOTE]
If the `undoStack` is empty, then there are no other commands left to be undone, and an `Exception` will be thrown when popping the `undoStack`.

The following sequence diagram shows how the undo operation works:

image::UndoRedoSequenceDiagram.png[width="800"]

The redo does the exact opposite (pops from `redoStack`, push to `undoStack`, and restores the address book to the state after the command is executed).

[NOTE]
If the `redoStack` is empty, then there are no other commands left to be redone, and an `Exception` will be thrown when popping the `redoStack`.

The user now decides to execute a new command, `edit`. As before, `edit` will be pushed into the `undoStack`. This time the `redoStack` is no longer empty. It will be purged as it no longer make sense to redo the `add n/David` command (this is the behavior that most modern desktop applications follow).

image::UndoRedoNewCommand2StackDiagram.png[width="800"]

Commands that are not undoable are not added into the `undoStack`. For example, `list`, which inherits from `Command` rather than `UndoableCommand`, will not be added after execution:

image::UndoRedoNewCommand3StackDiagram.png[width="800"]

The following activity diagram summarize what happens inside the `UndoRedoStack` when a user executes a new command:

image::UndoRedoActivityDiagram.png[width="650"]

==== Design Considerations

===== Aspect: Implementation of `UndoableCommand`

* **Alternative 1 (current choice):** Add a new abstract method `executeUndoableCommand()`
** Pros: We will not lose any undone/redone functionality as it is now part of the default behaviour. Classes that deal with `Command` do not have to know that `executeUndoableCommand()` exist.
** Cons: Hard for new developers to understand the template pattern.
* **Alternative 2:** Just override `execute()`
** Pros: Does not involve the template pattern, easier for new developers to understand.
** Cons: Classes that inherit from `UndoableCommand` must remember to call `super.execute()`, or lose the ability to undo/redo.

===== Aspect: How undo & redo executes

* **Alternative 1 (current choice):** Saves the entire prison book.
** Pros: Easy to implement.
** Cons: May have performance issues in terms of memory usage.
* **Alternative 2:** Individual command knows how to undo/redo by itself.
** Pros: Will use less memory (e.g. for `delete`, just save the person being deleted).
** Cons: We must ensure that the implementation of each individual command are correct.


===== Aspect: Type of commands that can be undone/redone

* **Alternative 1 (current choice):** Only include commands that modifies the address book (`add`, `edit`, `delete`).
** Pros: We only revert changes that are hard to change back (the view can easily be re-modified as no data are lost).
** Cons: User might think that undo also applies when the list is modified (undoing filtering for example), only to realize that it does not do that, after executing `undo`.
* **Alternative 2:** Include all commands.
** Pros: Might be more intuitive for the user.
** Cons: User have no way of skipping such commands if he or she just want to reset the state of the PrisonBook and not the view.
**Additional Info:** See our discussion  https://github.com/se-edu/addressbook-level4/issues/390#issuecomment-298936672[here].


===== Aspect: Data structure to support the undo/redo commands

* **Alternative 1 (current choice):** Use separate stack for undo and redo
** Pros: Easy to understand for new Computer Science student undergraduates to understand, who are likely to be the new incoming developers of our project.
** Cons: Logic is duplicated twice. For example, when a new command is executed, we must remember to update both `HistoryManager` and `UndoRedoStack`.
* **Alternative 2:** Use `HistoryManager` for undo/redo
** Pros: We do not need to maintain a separate stack, and just reuse what is already in the codebase.
** Cons: Requires dealing with commands that have already been undone: We must remember to skip these commands. Violates Single Responsibility Principle and Separation of Concerns as `HistoryManager` now needs to do two different things.
// end::undoredo[]

//tag::loginsecurity[]
=== Login and Security Feature
==== Current Implementation

The Login and Security feature in the PrisonBook is implemented using Users and Sessions.

===== Sessions
Sessions are implemented with a `Session` class which resides inside `Model Manager`. It supports the logging in and logging out of a user as well as support restricted access for specific commands. For example read access (list command) vs write access (add command and edit command).

image::ModelClassDiagramwSessionwCells.png[width="800"]

As can be seen from the diagram, a Session is initialised upon the creation of the ModelManager. The session stores information such as the logged-in user's username, as well as the security level of the user.

The accessibility of each command by the user is implemented on the logic level. Each command has a static `minimumSecurityLevel`. The usage of a command goes through the sequence diagram as follows (the example command being used here is the Delete command).

image::SecurityLevelSequenceDiagram.png[width="800"]

The `LogicManager` checks the `minSecurityLevel` of the command against the `securityLevel` of the current `Session` in the Model. If `the securityLevel` greater than or equal to the `minSecurityLevel`, the LogicManager will then call the `execute()` method on the Command.

===== Design Considerations

====== Aspect: Implementation for checking of security level for command access
* **Alternative 1 (current choice):** Implemented by the `LogicManager`
** Pros: Decreases coupling between `Command` and `Session`. This allows for flexibility in future implementation changes.
** Cons: Sequence during execution needs to go back and forth with the `LogicManager`
* **Alternative 2:** Implement at the `Command` level
** Pros: Easy to understand, the sequence during execution keeps moving on to the next step instead of going back and forth with the LogicManager.
** Cons: Commands are also responsible for checking if they should be run. Violates Single Responsibility Principle and Separation of Concerns as `HistoryManager` now needs to do two different things.


===== Users
Users are implemented with a `User` class, as well as a `UniqueUserMap` class which also reside in the `Model Manager`. +
The `UniqueUserMap` is implemented using a Hashmap which maps `usernames` as Keys and `User` as Values. Additionally, there is an internal list implemented via an `ObservableList` of all the Users in the Hashmap.

To save the database of the users, a new type is added to the storage so that it is able to store the Users in the storage file.

image::StorageClassDiagramwUserwCells.png[width="800"]

Upon initialization of the AddressBook, the AddressBook will read the user data from the storage file and create the internal list of Users. The list is then iterated through and mapped to the HashMap.

When adding and deleting users, both the Hashmap and the internal list are updated so as to reflect accurately in the model and stored correctly in the storage.

Currently, the user data, including passwords are stored in plaintext, which may pose a security problem. For future implementations, we will include hashing of the passwords before storage to as to increase the security of the application.


===== Design Considerations

====== Aspect: Data Structures for UniqueUserMap
* **Alternative 1 (current choice):** Hashmap + ObservableList
** Pros: Easy to access users, can immediately call up the correct `User` object by passing in the username key. Whereas the ObservableList is used to complement the storage of the user data, where it is necessary to iterate through all the Users in order to store in the storage .xml file.
** Cons: Duplicate information stored in two different data structures.
* **Alternative 2:** ObservableList only
** Pros: No duplication of Users. Storing is also easy as it uses the existing AddressBook storage framework which works with ObservableLists.
** Cons: Everytime we want to access a specific User, we have to iterate through the entire list of Users in order to do so.
* **Alternative 3:** HashMap only
** Pros: Fast access of users in O(1) time
** Cons: Unable to be stored efficiently with the current method of storing which works with XML file.

====== Aspect: Storage location of User Data
* **Alternative 1 (current choice):** Stored in the same XML File with the AddressBook data
** Pros: Easy to implement with current method of saving, where the entire AddressBook is upon an Address Book Changed Event. There is no need to maintain an additional stack for a User Database for UndoRedo.
** Cons: User data should theoretically be separated from AddressBook data (persons, cells, tags).
* **Alternative 2:** Store in a separate XML File
** Pros: Separation of storage for two different aspects. If User data file is corrupted, it does not affect the AddressBook data and vice versa.
** Cons: Very difficult to implement with the current method of saving. Furthermore, there needs to be addtional stacks implemented to keep track of the past states of User data for the UndoRedo functions.


//end::loginsecurity[]

// tag::cellmap[]
=== Prison Cell System
==== Current Implementation

In a prison, it is necessary to have cells where prisoners stay in.
It is important to keep track of the prisoners in the cell and whether the `Cell` is full.

This cell system is most clearly represented using a 2-D array.
Hence, this was used as the basis of the map system of the prison.
However, to prevent accidental changes, a read-only version of the cells are returned in an `ObservableList`.
Since this is part of the `Model` component of the PrisonBook, the `Model` component has been updated accordingly as shown below.
At the bottom of the `Model` class diagram, it has been updated to show how the cell system is linked to the other components.

image::ModelClassDiagramwSessionwCells.png[Width="550"]

To save and load the data of the cell system, storage also played an important component to ensure no data is lost when closing the app.
Below is a class diagram of `Storage` to show how the cells are saved. A new type is added to the storage so that it knows how to save and load data for cells.

image::StorageClassDiagramwUserwCells.png[Width="550"]

This map is shown on the user interface on the right side area, shown in the picture below.
Since the app is still being tested, the `map` command will also show the actual cells in the result display box.
This basic map shows the cell system and helps keep track of what is happening in the cells.

image::MapPanel.png[width="550"]

This cell system helps users visualise the locations of the prisoners more easily. Not only that, prisoners can also be added and removed from them.
These changes can be viewed in the bigger map which displays the number of people in individual cells below each cell address.

Assuming the user has access to the functions to add prisoners into prison cells, they can use the `addcell` command to do so.
Below is the sequence diagram of the logic and model components.

image::AddCellSequenceDiagram.PNG[width="550"]
image::AddCellModelSequenceDiagram.PNG[width="550"]

Besides the cell map system being updated, we will also update the addresses of these prisoners added to the prison, since they now live in the prison, rather than in their own homes.

Prisoners can also be removed from their cells using the `deletecell` command when they are being transferred to another cell,
or if they can leave prison and go back home to their loved ones.

To aid in adding prisoners to cells and deleting them from the cells, a `listcell` command has been implemented.
With this command, users can see who are in a specified cell. This helps users know whether the cell is full and
if some of these prisoners should not be added to the same cell.

For future implementations, we can also allow only the prison wardens/owners to redefine the maximum size of the prison as their prisons
may grow or shrink in the future. In this application, we will only show an example with 15 cells with a maximum of 2 prisoners per cell.
These values can be easily changed and we will customise it based on your needs. The naming of the cells can also be adjusted accordingly.

==== Design Considerations
===== Aspect: Data Structure of Cells in CellMap

* **Alternative 1 (current choice):** Use a 2-D array
** Pros: Easy to visualise the system.
** Cons: Harder to do more functions that the Java API has provided. Does not fit in with the other models of Person and Tag and their internalList.
It also makes it harder to implement undo and redo functions for actions below.
* **Alternative 2:** Use a 2-level ArrayList
** Pros: Can use Java functions meant for Lists, can have different number of units for each block
** Cons: Not uniform number of units for each block will be harder to take into consideration when using the individual cells.
* **Alternative 3:** Use an ObservableList
** Pros: Easier to save state of cells when undoing and redoing.
** Cons: Harder to visualise where each row of cells/prisons end.

===== Aspect: Implementation of ShowCellsCommand (`map`)

* **Alternative 1 (current choice):** Keep the map always on display.
** Pros: Easier to see when adding prisoners to cells and removing prisoners from cells.
** Cons: Anyone walking by from behind can see the information easily and compromises security.
* **Alternative 2:** Create a new Command to show the map.
** Pros: Easy to implement, similar to listing. Extending the current list of commands. Only when function is called can the map be seen.
** Cons: Easy to forget which cell in the map can add prisoners but the map is not permanently there.

===== Aspect: Implementation of AddCellCommand (`addcell`)

* **Alternative 1 (current choice):** Prisoners are added into cells in a cellMap and their addresses will be updated.
** Pros: Cells are always there and can hold prisoners. Since persons in the PrisonBook can be either prisoners or guards, not all persons may have a cell.
Easier to delete prisoners from cells and update their addresses accordingly when they are released from prison.
** Cons: Need to have extra implementation to ensure undo and redo commands work properly when deleting a prisoner who is imprisoned as well
as to remove them or add them to cells.
* **Alternative 2:** Not have a cell map but to add cells to prisoners.
** Pros: Might be more intuitive for the user, to check a prisoner's cell location.
** Cons: Harder to manage a system of cells. Easy to accidentally overcrowd a cell. Not all persons in PrisonBook are prisoners.
Some of them are guards.
* **Alternative 3:** Automatically assigning cells to prisoners
** Pros: Removes the burden of choosing a cell for user. Fewer commands required as prisoners are automatically added.
** Cons: More complex in automatically choosing cells for prisoners. User might want to have control on which prisoners should be in which cell.

===== Aspect: Implementation of ListCellCommand (`listcell`)

* **Alternative 1 (current choice):** Users to give cell address to show prisoners in them.
** Pros: Easy to implement, similar in structure to `Find` Command and its listing of persons.
** Cons: Need to find address of cell first that is required.
* **Alternative 2:** Clicking on a cell to show prisoners in them
** Pros: Might be more intuitive for the user to click on a cell.
** Cons: Not ideal for users who prefer CLI.


===== Aspect: Implementation of DeleteCellCommand (`deletecell`)

* **Alternative 1 (current choice):** Removes a prisoner from a cell by choosing the prisoner and updates his/her address back accordingly.
** Pros: Faster way to remove since only the index of the prisoner is required. User does not have to figure out which cell the prisoner he or she is in.
** Cons: Since cells have a size limit of 2, it is easier to delete a person after selecting a cell.
* **Alternative 2:** Choosing a cell and the person to delete from the cell after seeing the list.
** Pros: Easier to choose a cell when there are many people in the PrisonBook and is difficult to see who the prisoners are.
** Cons: Requires more steps to delete a person from the cell, by having to first list then delete.
Current implementation can work in a similar way that makes it easier to delete a prisoner from a cell.
// end::cellmap[]

//tag::findbytag[]
=== Find by Tag Command
==== Current Implementation
When the Find command is called, FindCommandParser will look for the tag and/or name prefixes (t/ and n/ respectively).
The arguments following each prefix will be made into a list. A mapping is then generated with the prefixes as the keys
 and the argument-lists as values. The name search portion will run like before, the tag search will follow a similar
 approach; creating a new predicate instance and return matching results if they exist.

image::FindCommand_sequence.png[Width="550"]

==== Design Considerations
===== Aspect: Find Command
* **Alternative 1 (current choice):** Add on to the current Find command
** Pros: Allows filtering by names and/or tags
** Cons: Requires user to include prefixes in the command to differentiate between name and tag arguments
* **Alternative 2:** Create new command for finding tags
** Pros: More convenient if user only needs to filter by tags or filter by names separately, no need for prefixes
** Cons: Cannot filter by names and tags in a single command

===== Aspect: Argument Deliminator
* **Alternative 1 (current choice):** Only one prefix with all arguments coming after, delimited by space
** Pros: Relatively convenient for user when they are inputting multiple arguments
** Cons: Easier for users to mistakenly merge two arguments into one when forgetting a space
* **Alternative 2:** One prefix required for each argument
** Pros: Allows user to order name and tag arguments in any order - the tag arguments and name arguments do not
 have to be grouped together after a single prefix
** Cons: May become tedious and redundant when inputting multiple arguments, more prone to typos and human error

//end::findbytag[]

//tag::scheduling[]
=== Scheduling with Google Calendar
==== Current Implementation
The PrisonBook calendar commands will instantiate a calendar class to interact with the Google Calendar API.
The initial step is to obtain valid credentials authorized from the API side to access its resources, then
the calendar class will send HTTPS requests to the server, whether it is calling the listEvents, addEvents or delEvents API command.
Upon receiving a success confirmation from the API, the change will be reflected next time any calendar commands are called.

Calendar Commands that are supported are:
* listing upcoming events
* adding an event
* removing an event

image::CalendarCommands_classDiagrams.png[Width="550"]

===== Aspect: Choosing Number of Accounts to Work With

 * **Alternative 1 (current choice):** Using one Google account for all prison staff
 ** Pros: Very simple to administrate and fits the needs of the project scope.
 ** Cons: No personalization for calendars of Warden/Guards.
 * **Alternative 2:** Use one Google account for Warden and one for Guards
 ** Pros: Two accounts is still relatively simple to maintain, allows for some separation of events-scheduling.
 ** Cons: All guards still share the same schedule, so they cannot have personal schedules.
 * **Alternative 3:** Use one Google account for Warden and one for Guards
 ** Pros: Two accounts is still relatively simple to maintain, allows for some separation of events-scheduling.
 ** Cons: All guards still share the same schedule, so they cannot have personal schedules.
 * **Alternative 4:** Use one Google account for Warden and one for Guards
 ** Pros: All prison staff have their own calendar to work with, where they can have private individual events.
 ** Cons: Hard to maintain because we have to make sure all staff have the master prison schedule of the inmates' activities non-overlapping with personal events. There will also be a lot of calendars to keep track of, depending on how many guards are hired.

===== Aspect: Choosing Number of Calendars per Person

* **Alternative 1 (current choice):** Only one calendar per person
** Pros: Simple to implement, administrate and satisfies users' daily tasks
** Cons: Events cannot overlap, limited to fit events in separate rigid time slots.
* **Alternative 2:** Multiple calendars per person
** Pros: Users can track multiple events happening at the same time. Different calendars can also be used to organize and group logically-related events.
** Cons: Complicated on the administration side and oversteps the scope of this enhancement. Not really looking to replace personal Google Calendars, this is just to allow prison staff to work with prison schedules.

=== View Calendar Feature
==== Current Implementation
The View Schedule feature can be accessed via entering the command `cal`.
It allows guards/wardens to see upcoming events and their start times.

===== Aspect: Event Listing UI

* **Alternative 1 (current choice):** List events as a list format
** Pros: Simple to implement, shows more details than calendar UI
** Cons: Not as visually pleasing, users cannot use mouse to edit calendar intuitively
* **Alternative 2:** List events in the calendar UI display
** Pros: More intuitive with an actual interactive calendar, allows users to click and drag using mouse
** Cons: No longer command line based, takes up more space than console

=== Add Event to Calendar Feature
==== Current Implementation
The Add Event feature can be accessed via entering the command `calAdd event/EVENTNAME loc/LOCATION start/STARTDATETIME end/ENDDATETIME`.
It allows guards/wardens to add an event, specifying the event name, location, starting and ending times.

image::CalendarAddCommand_sequence.png[Width="550"]

===== Aspect: Relevancy of Event Attendee List

* **Alternative 1 (current choice):** Excluding Attendee List
** Pros: Less content for user to input when creating events, does not restrict any functionality in a prison setting
** Cons: Slightly less customization when adding events
* **Alternative 2:** Including Attendee List
** Pros: Can invite specific individuals for smaller scale events
** Cons: Typing each user can become tedious and extra work for the users, also not suitable for prison setting because prisoners are not "invited" for meals or to get back into their cells

=== Delete Event from Calendar Feature
==== Current Implementation
The Delete Event feature can be accessed via entering the command `calDel EVENTNUMBER`.
It allows guards/wardens to remove events from the upcoming events list.
Since each event has its own eventID which is a random alphanumeric String, they are mapped to Integers through an ArrayList for easier selection by the users.

image::CalendarDeleteCommand_sequence.png[Width="550"]

===== Aspect: Specification of Which Event to Delete

* **Alternative 1 (current choice):** Enumerating the event list and storing it in an array
** Pros: Easy interface for users, they just pick a simple integer from the list
** Cons: Have to map these enumerations to the actual IDs
* **Alternative 2:** Displaying the actual event IDs from the API
** Pros: No additional parsing or eventID storing is needed
** Cons: Users have to type the event IDs manually, which are seemingly random alphanumeric strings (prone to human error)
* **Alternative 3:** No change to list
** Pros: No additional clutter to existing list
** Cons: Users have to specify event name and start/end times, which is quite tedious


//end::scheduling[]

// tag::dataencryption[]
=== [Proposed] Data Encryption

_{Explain here how the data encryption feature will be implemented}_

// end::dataencryption[]

=== Logging

We are using `java.util.logging` package for logging. The `LogsCenter` class is used to manage the logging levels and logging destinations.

* The logging level can be controlled using the `logLevel` setting in the configuration file (See <<Implementation-Configuration>>)
* The `Logger` for a class can be obtained using `LogsCenter.getLogger(Class)` which will log messages according to the specified logging level
* Currently log messages are output through: `Console` and to a `.log` file.

*Logging Levels*

* `SEVERE` : Critical problem detected which may possibly cause the termination of the application
* `WARNING` : Can continue, but with caution
* `INFO` : Information showing the noteworthy actions by the App
* `FINE` : Details that is not usually noteworthy but may be useful in debugging e.g. print the actual list instead of just its size

[[Implementation-Configuration]]
=== Configuration

Certain properties of the application can be controlled (e.g App name, logging level) through the configuration file (default: `config.json`).

== Documentation

We use asciidoc for writing documentation.

[NOTE]
We chose asciidoc over Markdown because asciidoc, although a bit more complex than Markdown, provides more flexibility in formatting.

=== Editing Documentation

See <<UsingGradle#rendering-asciidoc-files, UsingGradle.adoc>> to learn how to render `.adoc` files locally to preview the end result of your edits.
Alternatively, you can download the AsciiDoc plugin for IntelliJ, which allows you to preview the changes you have made to your `.adoc` files in real-time.

=== Publishing Documentation

See <<UsingTravis#deploying-github-pages, UsingTravis.adoc>> to learn how to deploy GitHub Pages using Travis.

=== Converting Documentation to PDF format

We use https://www.google.com/chrome/browser/desktop/[Google Chrome] for converting documentation to PDF format, as Chrome's PDF engine preserves hyperlinks used in webpages.

Here are the steps to convert the project documentation files to PDF format.

.  Follow the instructions in <<UsingGradle#rendering-asciidoc-files, UsingGradle.adoc>> to convert the AsciiDoc files in the `docs/` directory to HTML format.
.  Go to your generated HTML files in the `build/docs` folder, right click on them and select `Open with` -> `Google Chrome`.
.  Within Chrome, click on the `Print` option in Chrome's menu.
.  Set the destination to `Save as PDF`, then click `Save` to save a copy of the file in PDF format. For best results, use the settings indicated in the screenshot below.

.Saving documentation as PDF files in Chrome
image::chrome_save_as_pdf.png[width="300"]

[[Testing]]
== Testing

=== Running Tests

There are three ways to run tests.

[TIP]
The most reliable way to run tests is the 3rd one. The first two methods might fail some GUI tests due to platform/resolution-specific idiosyncrasies.

*Method 1: Using IntelliJ JUnit test runner*

* To run all tests, right-click on the `src/test/java` folder and choose `Run 'All Tests'`
* To run a subset of tests, you can right-click on a test package, test class, or a test and choose `Run 'ABC'`

*Method 2: Using Gradle*

* Open a console and run the command `gradlew clean allTests` (Mac/Linux: `./gradlew clean allTests`)

[NOTE]
See <<UsingGradle#, UsingGradle.adoc>> for more info on how to run tests using Gradle.

*Method 3: Using Gradle (headless)*

Thanks to the https://github.com/TestFX/TestFX[TestFX] library we use, our GUI tests can be run in the _headless_ mode. In the headless mode, GUI tests do not show up on the screen. That means the developer can do other things on the Computer while the tests are running.

To run tests in headless mode, open a console and run the command `gradlew clean headless allTests` (Mac/Linux: `./gradlew clean headless allTests`)

=== Types of tests

We have two types of tests:

.  *GUI Tests* - These are tests involving the GUI. They include,
.. _System Tests_ that test the entire App by simulating user actions on the GUI. These are in the `systemtests` package.
.. _Unit tests_ that test the individual components. These are in `seedu.address.ui` package.
.  *Non-GUI Tests* - These are tests not involving the GUI. They include,
..  _Unit tests_ targeting the lowest level methods/classes. +
e.g. `seedu.address.commons.StringUtilTest`
..  _Integration tests_ that are checking the integration of multiple code units (those code units are assumed to be working). +
e.g. `seedu.address.storage.StorageManagerTest`
..  Hybrids of unit and integration tests. These test are checking multiple code units as well as how the are connected together. +
e.g. `seedu.address.logic.LogicManagerTest`


=== Troubleshooting Testing
**Problem: `HelpWindowTest` fails with a `NullPointerException`.**

* Reason: One of its dependencies, `UserGuide.html` in `src/main/resources/docs` is missing.
* Solution: Execute Gradle task `processResources`.

== Dev Ops

=== Build Automation

See <<UsingGradle#, UsingGradle.adoc>> to learn how to use Gradle for build automation.

=== Continuous Integration

We use https://travis-ci.org/[Travis CI] and https://www.appveyor.com/[AppVeyor] to perform _Continuous Integration_ on our projects. See <<UsingTravis#, UsingTravis.adoc>> and <<UsingAppVeyor#, UsingAppVeyor.adoc>> for more details.

=== Coverage Reporting

We use https://coveralls.io/[Coveralls] to track the code coverage of our projects. See <<UsingCoveralls#, UsingCoveralls.adoc>> for more details.

=== Documentation Previews
When a pull request has changes to asciidoc files, you can use https://www.netlify.com/[Netlify] to see a preview of how the HTML version of those asciidoc files will look like when the pull request is merged. See <<UsingNetlify#, UsingNetlify.adoc>> for more details.

=== Making a Release

Here are the steps to create a new release.

.  Update the version number in link:{repoURL}/src/main/java/seedu/address/MainApp.java[`MainApp.java`].
.  Generate a JAR file <<UsingGradle#creating-the-jar-file, using Gradle>>.
.  Tag the repo with the version number. e.g. `v0.1`
.  https://help.github.com/articles/creating-releases/[Create a new release using GitHub] and upload the JAR file you created.

=== Managing Dependencies

A project often depends on third-party libraries. For example, PrisonBook depends on the http://wiki.fasterxml.com/JacksonHome[Jackson library] for XML parsing. Managing these _dependencies_ can be automated using Gradle. For example, Gradle can download the dependencies automatically, which is better than these alternatives. +
a. Include those libraries in the repo (this bloats the repo size) +
b. Require developers to download those libraries manually (this creates extra work for developers)

[[GetStartedProgramming]]
[appendix]
== Product Scope

*Target user profile*:

* works at a prison with around 1000 inmates
* has a need to keep track of prisoner locations and details
* has a need to organize and direct guards efficiently
* has a need to manage a significant number of contacts
* prefer desktop apps over other types
* can type fast
* prefers typing over mouse input
* is reasonably comfortable using CLI apps

*Value proposition*: manage contacts faster than a typical mouse/GUI driven app

*Feature Contributions*:

// tag::FeatureContributionPhilos[]

* Chung-Yen (Philos) Tsai (philos22)
  1. Major enhancement: +
  Scheduling: Keeps track of schedule of prisoners and guards.
  2. Minor enhancement: +
  Find by tag: This function will allow admins to filter user list by tags. Tags may include classification of Prisoner vs. Guards, Prisoner cell blocks and cell numbers, Guards' current teams and assignments, etc...

// end::FeatureContributionPhilos[]
// tag::FeatureContributionIsaac[]

* Isaac Gideon Tan (zacci)
  1. Major enhancement: +
  Login and Authorization Levels: Enable creation of account for guards, logging in, and authorization levels for commands that may compromise the security of the Prison data.
  2. Minor enhancement: +
  Additional Attribute to store 'Role' information. To identify the person as a Prisoner or Guard

// end::FeatureContributionIsaac[]
// tag::FeatureContributionSarah[]

* Sarah Goh Shi Ning (sarahgoh97)
  1. Major enhancement: +
  Creating a cell system of all the prison cells in the prison.
  This helps users add and remove prisoners to their prison and prevent users from overcrowding their prison.
  It can also help users keep track of locations of the cells of each prisoner.
  Users can also add and remove prisoners more easily by first listing people in each cell to decide where to add or remove them.
  2. Minor enhancement: +
  Show map of the cell system on the UI.
  Also implemented the UI to show the list of persons and the map when first logged in
  and to hide it when logging out and when the application is first opened.
// end::FeatureContributionSarah[]

// tag::UserStories[]
[appendix]
== User Stories

Priorities: High (must have) - `* * \*`, Medium (nice to have) - `* \*`, Low (unlikely to have) - `*`

[width="59%",cols="22%,<23%,<25%,<30%",options="header",]
|=======================================================================
|Priority |As a ... |I want to ... |So that I can...
|`* * *` |administrator |group guards together |form teams to carry out various tasks: patrol rotations, perimeter control, cell guards

|`* * *` |guard |have a track record of each prisoner’s past offences
                          Type 1 – Injuring guard
                          Type 2 – Infighting with other inmates
                          Type 3 – Vandalism
 |use the appropriate level of precaution when dealing with unruly individuals

|`* * *` |guard |keep track of each prisoner’s holding cells |ensure that there are two prisoners per cell and that certain bad prisoner combinations are avoided

|`* * *` |prison warden |assign ranks to each guard |enforce access rights to view/edit prisoner and officer data

|`* * *` |guard |check the length of imprisonment of prisoners I am in charge of |know when they are leaving

|`* * *` |guard |add prisoners to prison cells |the prisoners have a prison cell to stay in

|`* * *` |guard |check number of prison cells available |decide whether to take more prisoners in

|`* * *` |guard |delete a prisoner |add more prisoners to prison

|`* * *` |guard |check when I am on duty |see when I have to come to work

|`* * *` |guard |check who are in my team |coordinate with my team

|`* * *` |prison warden |add police officers |give access to new police officers

|`* *` |guard |assign prisoners to different recess blocks |separate those that start fights or cause trouble when together

|`* *` |prison warden |shuffle patrol guards around teams every day |each team is made up of different members every day, prisoners will acquaint themselves with specific guards

|`* *` |prison warden |divide cells into blocks (1, 2, 3) and name each cell numerically (1-1, 1-2, etc…) |refer to each cell easily when assigning prisoners to them

|`* *` |guard |check whether there are visitor appointments |inform prisoners and bring them to see their visitors

|`* *` |guard |edit details of prisoners |update information of prisoners

|`* *` |guard |transfer people to other prisons |have more empty cells for more prisoners

|`*` |prisoner |know my release date |look forward to the day I can see my family/friends again

|`*` |guard |see my assigned prisoners’ social networks: friends, enemies, family, etc… |use this as reference when dealing with inmates

|`*` |guard |assign prisoners to solitary confinement |punish those that have continuously committed serious offences

|`*` |cook |check dietary requirements of all people in prison |cook sufficient food

|`*` |counselor |check what prisoners' crimes |understand my patients better

|=======================================================================

// end::UserStories[]

// tag::UseCases[]
[appendix]
== Use Cases

[discrete]
=== Use case: Add an event on the calendar.
Actor: Guard (Guard)

*MSS*

1.  Guard requests to add event to calendar.
2.  PrisonBook adds event to calendar.
+
Use case ends.

*Extensions*

[none]
* 1a. PrisonBook detects that guard's security level is not high enough.
+
[none]
** 1a1. PrisonBook shows an error message regarding security level.
+
Use case ends.

* 1b. The format of adding event to calendar is wrong.
+
[none]
** 1b1. PrisonBook shows an error message.
+
Use case ends.

[discrete]
=== Use case: Add prisoner to a cell
Actor: Guard

*MSS*

1. PrisonBook shows a list of available cells.
2. Guard selects a prisoner and cell to add.
3. PrisonBook updates prisoner status and cell status.
+
Use case ends.

*Extensions*

[none]
* 1a. Guard does not have sufficient access to view cells.
+
Use case ends.

* 2a. PrisonBook detects that prisoner is already added to a cell.
+
[none]
** 2a1. PrisonBook sends an error message regarding prisoner already imprisoned.
+
Use case resumes at step 1.

* 3a. PrisonBook detects that the cell is already full.
+
[none]
** 3a1. PrisonBook sends an error message regarding adding prisoner to a full cell.
+
Use case resumes at step 1.

* 4a. PrisonBook detects that address of cell is invalid.
+
[none]
** 4a1. PrisonBook sends an error message regarding invalid cell address.
+
Use case resumes at step 1.

[discrete]
=== Use case: Get the list of prisoners in a certain cell
Actor: Guard

*MSS*

1.  Guard requests a list of prisoners in a specified cell
2.  PrisonBook shows the list of prisoners in specified cell
+
Use case ends.

*Extensions*

[none]
* 2a. Guard does not have access rights to view the details of the requested cell
+
Use case ends.

// end::UseCases[]

// tag::NFR[]
[appendix]
== Non Functional Requirements

.  Should work on any mainstream OS as long as it has Java `1.8.0_60` or higher installed.
.  Should be able to hold up to 1000 persons without a noticeable sluggishness in performance for typical usage.
.  A user with above average typing speed for regular English text (i.e. not code, not system admin commands) should be able to accomplish most of the tasks faster using commands than using the mouse.
.  Should work for 32-bit and 64-bit environments
.  System should respond within 2 seconds
.  Should have different levels of access for users of different ranks.
.  Should have a backup copy at all times in case a user accidentally deletes any information.

// end::NFR[]

[appendix]
== Glossary

[[mainstream-os]] Mainstream OS::
Windows, Linux, Unix, OS-X

[[warden]] Prison warden::
Owner of the prison, who has the highest level of access available.

[[guard]] Guard::
A person working in the prison, to watch over prisoners and ensure order.

[[prisoner]] Prisoner::
A person has been sent to prison for a crime.

[[cell]] Cell::
A place where prisoners stay and live in when they are imprisoned.
Each cell has a maximum number of people who can live in them to prevent overcrowding.
Their addresses are fixed and cannot be changed unless the application is customised.

[appendix]
== Instructions for Manual Testing

Given below are instructions to test the app manually.

[NOTE]
These instructions only provide a starting point for testers to work on; testers are expected to do more _exploratory_ testing.

=== Launch and Shutdown

. Initial launch

.. Download the jar file and copy into an empty folder
.. Double-click the jar file +
   Expected: Shows the GUI with a set of sample prisoners and guards. The window size may not be optimum.
.. Please do not open the jar file through a terminal.
. Saving window preferences

.. Resize the window to an optimum size. Move the window to a different location. Close the window.
.. Re-launch the app by double-clicking the jar file. +
   Expected: The most recent window size and location is retained.

// tag::isaactest[]

=== Major Feature: Users, Sessions and Security Levels
==== Logging in and Logging out
. For security purposes, users of PrisonBook need to login with their user details in order to to view the information on the PrisonBook. They can also logout after finishing their session, so that the next person will need to login again.

.. Prerequisites: You must not be logged in. (By default, you are not logged in when you first open the application.) +
   Test case: Type `login user/prisonguard pw/password1` +
   Expected: PrisonBook will display `Login Success`

.. Prerequisites: You are logged in. +
   Test case: Type `status` to show your current session's details +
   Expected: `Username: prisonguard Security Level: 1`

.. Prerequisites: You are logged in. +
   Test case: Type `logout` to logout +
   Expected: PrisonBook will display `Successfully logged out`. Furthermore the person details in the left panel will be cleared, and the cell details in the right panel will reflect that you have insufficient authority to view the information.

==== Commands have restricted access
. A minimum Security Level is required to use and access certain commands. +
Refer to Section 5: Command Summary for the detailed list of commands and their respective minimum security level ranging from 0 to 3.

.. Test case: Type `logout` to ensure that you are logged out. (By default you are not logged in when you first open the application) +
   Type `list` +
   Expected: PrisonBook will show `Your security level is insufficient to access this command.` +
.. Test case: Login using `login user/prisonleader pw/password2` (This user has Security Level of 2) +
   Type `list` +
   Expected: PrisonBook will say `Listed all persons` and show the full list of persons on the left column of the UI. +
   You can test the other commands with the following user details:
   ... `login user/prisonwarden pw/password3` Security Level 3.
   ... `login user/prisonleader pw/password2` Security Level 2.
   ... `login user/prisonguard pw/password1` Security Level 1.

==== Adding a new user
. You can add new users to the PrisonBook when you want to give access to new people.

.. Prerequisites: Have sufficient security level[3] +
   Test case: `adduser user/prisonguard99 pw/password2 sl/1` +
   Expected: `New user prisonguard99 added to PrisonBook` +
   You can then proceed to logout and attempt to login with the new user `prisonguard99`.

.. Prerequisites: Have sufficient security level[3] +
   Test case: `adduser user/prisonwarden pw/password3 sl/3` +
   Expected: `prisonwarden is already a user in PrisonBook` +

==== Deleting a user
. You can delete users from the PrisonBook

.. Prerequisites: You must be logged in with a higher security level than the user you want to delete. (Users with security level 3 can delete anyone, including other security level 3 users.) +
   Test case: Login with `login user/prisonleader pw/password2`, then type `deleteuser user/prisonguard99` (Which was added above in F.2.3) +
   Expected: `User has been successfully deleted`. You can logout and attempt to login to `prisonguard99` but you will not be able to successfully login as the user has been deleted.

.. Prerequisites: You must be logged in with a minimum security level of 2. +
   Test case: `delete user/nonexistentuser`
   Expected: `The username does not exist`

=== Minor Feature: Role Attribute added to Persons
. Allow user to indicate to the PrisonBook if added person is a Guard or a Prisoner.

.. Prerequisites: Have sufficient security level[2]
.. Test case: `add n/Sample Prisoner a/Chua Chu Kang p/91234567 e/sp@example.com r/p` +
   Expected: New person to show up on the UI with the name Sample Prisoner and shown to be a Prisoner on the person card.
.. Test case: `add n/Sample Guard a/Chua Chu Kang p/91234567 e/sg@example.com r/g` +
   Expected: New person to show up on the UI with the name Sample Guard and shown to be a Guard on the person card.

// end::isaactest[]

// tag::sarahtest[]
=== Minor Feature: Showing prisoners in the UI
. Map panel in UI showing the map of cells in the system.

.. Prerequisites: Have sufficient security level[1]
.. Test case: Starting up the app and before logging in +
   Expected: No details regarding cells shown on the map. Will show 0 persons in PrisonBook.
   Map shows that user has insufficient access to view information.
.. Test case: Using features below while logged in +
   Expected: UI matches what `map` command shows on the display. Will show number of persons in PrisonBook.

=== Major Feature: Managing prisoners in a prison
==== Adding a prisoner to a cell

. Adding a prisoner to a cell when all prisoners are listed and has sufficient security level [2].

.. Prerequisites: List all persons using the `list` command. Multiple persons in the list, from initial state of program.
.. Test case: `addcell 5 1-5` (person at index is a prisoner and is not in a cell and cell is not full) +
   Expected: Fifth person is added to the cell with address 1-5.
   Address of the prisoner updated in the person card and message of prisoner added to cell is displayed.
   The map on the right side of the UI will also update correspondingly by adding to the number corresponding to cell address 1-5.
   Timestamp in the status bar is updated.
.. Test case: `addcell 0 1-4` +
   Expected: No prisoner is added to a cell because of the index.
   Error message displayed regarding format. The map and status bar will not be updated.
.. Other incorrect add cell commands to try: `ac`, `addcell 2 1=1` +
   Expected: No change to UI and displays error message.

==== Deleting prisoner from a cell

. Deleting a prisoner from a cell when all prisoners are listed and has sufficient security level [2].

.. Prerequisites: List all persons using the `list` command. Multiple persons in the list, from initial state of program.
.. Test case: `deletecell 1` +
   Expected: Prisoner is deleted from his/her cell and their original cell will be updated.
   Message regarding prisoner being released will be displayed.
   The map on the right will be updated, as well as the prisoner's address back to their old address.
.. Test case: `deletecell 0` +
   Expected: No change to map and to the list of persons.
   Message regarding error will be shown for correct format of command.
.. Other incorrect delete cell commands to try: `dc`, `dc 0` +
   Expected: Similar to previous.

==== Listing prisoners in a cell

. Listing a prisoner from a cell when here is sufficient security level [1].
.. Test case: `listcell 1-1` +
   Expected: List of prisoners in cell address 1-1 will be updated and shown.
.. Test case: `listcell 10-10` +
   Expected: There is no change in the UI except the error message regarding an invalid cell.
.. Other incorrect list cell commands to try: `lc`, `lc 1` +
   Expected: Similar to previous.

// end::sarahtest[]

// tag::philostest[]
=== Major Feature: Scheduling with Google Calendar

==== Listing 10 upcoming events
Allows guards and prison warden to view the upcoming 10 events scheduled in Google Calendar.

.. Prerequisites: Have sufficient security level[1] +
   Test case: Type `cal` or `calendar`, if this is your first time connecting to Google Calendar, you will need to log into the PrisonBook Calendar account:
   A new browser window will open, do NOT close the window before you have logged in!
   Use email: prisonbooksystem@gmail.com
   Use password: prisonbook2018
   Expected: 10 upcoming events will be listed, each showing an assigned Event Number, Event Name, Time range and Location. +

==== Adding an event
. You can add new events to the PrisonBook Calendar.

.. Prerequisites: Have sufficient security level[3] +
   Test case: `calA event/Showing this works loc/NUS start/2018-04-28 12:00:00 end/2018-04-28 13:00:00` +
   Expected: `A new event will have been added to the calendar on April 28 at 12 o'clock.`

.. Prerequisites: Have sufficient security level[3] +
   Test case: `calA event/Showing this works loc/NUS start/2018-04-28 12:00:00 end/2017-04-28 13:00:00` +
   Expected: `The API will throw an error because the end date is earlier than the start date. It will tell you the time range is empty.` +

==== Deleting an event
. You can delete events from the listed Calendar events

.. Prerequisites: Have sufficient security level[3] +
   Test case: `calD 2` +
   Expected: The second event (Event 2) will have been deleted next time you call the `cal` list event command.

.. Prerequisites: Have sufficient security level[3] +
   Test case: `calD abc`
   Expected: The application will not allow you to call this  because `abc` is not a valid event number listed.

=== Minor Feature: Find by Tags
. Allow user to find persons by tags as well as names

.. Prerequisites: Have sufficient security level[1]
.. Test case: `find n/Alex t/ChickenAllergy` +
   Expected: 1 person listed: Alex Yeoh who is allergic to chickens.
.. Test case: `find t/Vegetarian` +
   Expected: 1 person listed: Bernice Yu who is a Vegetarian.
// end::philostest[]

=== Saving data

. Dealing with missing/corrupted data files

.. Should the data file be missing, a sample prison book will be provided, with the 3 users mentioned in the user guide:
prisonwarden, prisonleader and prisonguard
